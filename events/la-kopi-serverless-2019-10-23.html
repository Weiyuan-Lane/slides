<!DOCTYPE html><html><head><link rel="shortcut icon" type="image/x-icon" href="data:image/vnd.microsoft.icon;base64,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"/><meta name="google-site-verification" content="1yJwtZmUEW1QsrrIvRrXiBHA4O1yBmKeJBxP3txMgrI"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Doing more with (server)less</title><meta name="twitter:card" content="summary"/><meta property="og:title" content="Doing more with (server)less"/><meta property="og:description" content="The Speedrun of Serverless, with Google Cloud Platform"/><meta property="og:image" content="/slides/_next/static/images/introPic.0b53883ee5a9ec0.png"/><link rel="stylesheet" href="/slides/static/reveal-3.8.0/theme/sky.css"/><link rel="stylesheet" href="/slides/static/reveal-3.8.0/reveal.css"/><link rel="stylesheet" href="/slides/static/reveal-3.8.0/lib/monokai.css"/><meta name="next-head-count" content="10"/><link rel="preload" href="/slides/_next/static/css/styles.476a52a2.chunk.css" as="style"/><link rel="stylesheet" href="/slides/_next/static/css/styles.476a52a2.chunk.css"/><link rel="preload" href="/slides/_next/static/-e3eD8hdXzp4DvZnnEhFP/pages/events/la-kopi-serverless-2019-10-23.js" as="script"/><link rel="preload" href="/slides/_next/static/-e3eD8hdXzp4DvZnnEhFP/pages/_app.js" as="script"/><link rel="preload" href="/slides/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" as="script"/><link rel="preload" href="/slides/_next/static/chunks/commons.6f1451d25cef949d9e7d.js" as="script"/><link rel="preload" href="/slides/_next/static/runtime/main-188324fc68481e6230d8.js" as="script"/><link rel="preload" href="/slides/_next/static/chunks/styles.18a0b7b5f0329dd7ac6b.js" as="script"/></head><body><div id="__next"><div class="reveal background-white-translucent"><div class="slides"><section><h2>Doing More With (Server)less</h2><p>&quot;P2, Recapping the Speedrun of Serverless, <br/> With Google Cloud Console (UI)&quot;</p><img src="/slides/_next/static/images/introPic.0b53883ee5a9ec0.png" class="banner image-s"/><p><small>By <a href="https://weiyuan-lane.github.io">Weiyuan Liu | Rakuten Viki</a></small></p></section><section><h3>This is P2 of the speedrun</h3><img data-src="/slides/_next/static/images/shockedCat.c67fb0918551148.jpg" style="max-height:20%;max-width:20%;width:20%"/><p>For the slides in P1, go <a target="_blank" href="https://drive.google.com/open?id=1n6S6rYLYbQwEntyqNW8gk3yCvOOhQEPINhT3oOEbMnw">here</a> </p></section><section><h3>Overview</h3><ul class="aquablue-list pseudo-h6"><li class="fragment">Created new Google Cloud Platform project</li><li class="fragment">Deployed CICD pipeline with Cloud Build</li><li class="fragment">Assigned roles to service account for Cloud Build to perform deployment for App Engine and Cloud Run </li><li class="fragment">Deployed Web application(s) to App Engine &amp; Cloud Run</li></ul></section><section><h3>Let&#x27;s examine the speedrun,<br/> in <b>10</b> distinct steps</h3></section><section><h5>#1 - Create the Project</h5><img data-src="/slides/_next/static/images/reviewStep1.2fe5f89339293cf.png" class="image-m"/></section><section><h5>#2a - Enable App Engine </h5><img data-src="/slides/_next/static/images/reviewStep2a.61f2e11a3652a58.png" class="image-m"/><ul class="aquablue-list pseudo-h6 "><li class="fragment">Assess the above from the Navgation Menu - &quot;App Engine &gt; Dashboard&quot;</li><li class="fragment">Click the <b>Create Application</b> button</li></ul></section><section><h5>#2b - Select App Engine Region</h5><img data-src="/slides/_next/static/images/reviewStep2b.612e2e589dd85d3.png" class="image-m"/></section><section><h5>#2c - Set App Engine Core Configuration</h5><img data-src="/slides/_next/static/images/reviewStep2c.fc80afd93ceb437.png" class="image-m"/><p class="pseudo-h6s">See more on choosing the appropriate<br/> App Engine environment <a href="https://cloud.google.com/appengine/docs/the-appengine-environments" target="_blank">here</a></p></section><section><h5>#3 - Enable App Engine Admin API</h5><img data-src="/slides/_next/static/images/reviewStep3.9104ebf444c8246.png" class="image-m"/><ul class="aquablue-list pseudo-h6"><li class="fragment">Assess the above from the Navgation Menu - &quot;APIs &amp; Services &gt; Dashboard&quot;</li><li class="fragment">Search for &quot;App Engine Admin API&quot; and click the <b>Enable</b> button</li><li class="fragment">See <a href="https://cloud.google.com/appengine/docs/admin-api/overview" target="_blank">here</a> on why this API is required</li></ul></section><section><h5>#4 - Enable Cloud Run</h5><img data-src="/slides/_next/static/images/reviewStep4.29621b28303b57d.png" class="image-m"/><ul class="aquablue-list pseudo-h6"><li class="fragment">Assess the above from the Navgation Menu - &quot;Cloud Run&quot;</li><li class="fragment">Click the <b>Start Using Cloud Run</b> button</li></ul></section><section><h5>#5 - Enable Cloud Build (for CI/CD)</h5><img data-src="/slides/_next/static/images/reviewStep5.78a3aa8060cb2f0.png" class="image-m"/><ul class="aquablue-list pseudo-h6"><li class="fragment">Assess the above from the Navgation Menu - &quot;Cloud Build&quot;</li><li class="fragment">Click the <b>Enable Cloud Build API</b> button</li></ul></section><section><h5>#6a - Add Cloud Build configuration</h5><img data-src="/slides/_next/static/images/reviewStep6a.11eee918119f476.png" class="image-m"/><ul class="aquablue-list pseudo-h6"><li class="fragment">Assess the above from the Navgation Menu - &quot;Cloud Build &gt; Triggers&quot;</li><li class="fragment">Click <b>Connect Repository</b></li></ul></section><section><h5>#6b - Connect Repository</h5><img data-src="/slides/_next/static/images/reviewStep6b.57870297235325c.png" class="image-m"/><ul class="aquablue-list pseudo-h6"><li class="fragment">Select the correct code repository product that you are using</li><li class="fragment">Click <b>Continue</b> once you&#x27;re ready</li></ul></section><section><h5>#6c - Proceed to add build trigger</h5><img data-src="/slides/_next/static/images/reviewStep6c.3692eb39c2f0d36.png" class="image-m"/><ul class="aquablue-list pseudo-h6"><li class="fragment">Click <b>Add Trigger</b></li></ul></section><section><h5>#6d - Connect Repository</h5><img data-src="/slides/_next/static/images/reviewStep6d.087b4f477373ba5.png" class="image-m"/><ul class="aquablue-list pseudo-h6"><li class="fragment">Select the &quot;Build configuration&quot; setting as seen above</li><li class="fragment">Add branch regex (optional) if you only want to target a certain group of branches</li><li class="fragment">Click <b>Create Trigger</b></li></ul></section><section><h5>#7 - Add IAM roles to Cloud Build Service Account</h5><img data-src="/slides/_next/static/images/reviewStep7.91f70811ef987c2.png" class="image-m"/><ul class="aquablue-list pseudo-h6"><li class="fragment">Assess the above from the Navgation Menu - &quot;IAM &amp; admin &gt; IAM&quot;</li><li class="fragment">Add the above IAM roles to <b>${id}@cloudbuild.gserviceaccount.com</b>. This is a service account that is the underlying identity when running Cloud Build.</li><li class="fragment">View the privileges offered under the above roles from Navigation Menu - &quot;IAM &amp; admin &gt; Roles&quot;</li></ul></section><section><h5>#8 - Add App Engine Configuration to codebase</h5><pre><code class="hljs yaml">runtime: nodejs10
instance_class: B1
manual_scaling:
  instances: 1

handlers:
- url: /static
  static_dir: static
- url: /public
  static_dir: public
- url: /client-assets
  static_dir: client-assets                </code></pre><p class="pseudo-h6 fragment">Add the above in the root dir of project as <b>app.yaml</b></p><p class="pseudo-h6 fragment">App Engine configuration differs between environment (Standard VS Flexible). Do check out the standard configuration <a href="https://cloud.google.com/appengine/docs/standard/nodejs/config/appref" target="_blank">here</a> and flexible configuration <a href="https://cloud.google.com/appengine/docs/flexible/nodejs/reference/app-yaml" target="_blank">here</a> .</p><p class="pseudo-h6 fragment">See code base that I used <a href="https://github.com/Weiyuan-Lane/slides/tree/backup/serverless-demo" target="_blank">here</a> .</p></section><section><h5>#9 - Add Cloud Build Configuration to codebase</h5><pre><code class="hljs yaml">timeout: &#x27;600s&#x27;
steps:
- id: init
  waitFor: [&#x27;-&#x27;]
  name: &#x27;gcr.io/cloud-builders/npm&#x27;
  args: [&#x27;install&#x27;]

- id: frontendTest
  waitFor: [&#x27;init&#x27;]
  name: &#x27;gcr.io/cloud-builders/npm&#x27;
  args: [&#x27;run&#x27;, &#x27;f-test&#x27;]

- id: backendTest
  waitFor: [&#x27;init&#x27;]
  name: &#x27;gcr.io/cloud-builders/npm&#x27;
  args: [&#x27;run&#x27;, &#x27;b-test&#x27;]

- id: buildAssets
  waitFor: [&#x27;frontendTest&#x27;, &#x27;backendTest&#x27;]
  name: &#x27;gcr.io/cloud-builders/npm&#x27;
  args: [&#x27;run&#x27;, &#x27;build&#x27;]

- id: appEngineDeploy
  waitFor: [&#x27;buildAssets&#x27;]
  name: &#x27;gcr.io/cloud-builders/gcloud&#x27;
  args: [&#x27;app&#x27;, &#x27;deploy&#x27;, &#x27;-q&#x27;, &#x27;--project&#x27;, &#x27;$PROJECT_ID&#x27;]

- id: cloudRunDeploy
  waitFor: [&#x27;frontendTest&#x27;, &#x27;backendTest&#x27;]
  name: &#x27;gcr.io/cloud-builders/gcloud&#x27;
  entrypoint: &#x27;sh&#x27;
  args:
    - -c
    - |
      gcloud builds submit --tag gcr.io/$PROJECT_ID/webapp:1 -q
      gcloud beta run deploy --image gcr.io/$PROJECT_ID/webapp:1 -q --allow-unauthenticated --platform=&quot;managed&quot; --region=&quot;us-central1&quot; webapp
                </code></pre><p class="pseudo-h6 fragment">Add the above in the root dir of project as <b>cloudbuild.yaml</b></p><p class="pseudo-h6 fragment">The above runs the application&#x27;s unit tests, before building the assets and deploying the applications to Cloud Run and App Engine. See <a href="https://cloud.google.com/cloud-build/docs/build-config" target="_blank">here</a> for more details on Cloud Build&#x27;s configuration.</p></section><section><h5>#10 - Commit the configurations</h5><img data-src="/slides/_next/static/images/reviewStep10.70046fc7a05b500.png" class="image-m"/><p class="pseudo-h6 fragment">Committing the code above will trigger Cloud Build to starting building based on the trigger from <b>#6</b></p></section><section><h4>Viola! Wait for a few minutes before your web applications are deployed</h4><br/><p class="pseudo-h6">Note that you might want to omit the usage of <b>Cloud Run</b> if you&#x27;re using <b>App Engine</b>, or vice versa, as you only need to serve a web application from one of them. Amend from the Cloud Build steps to select the tool to use for your web application.<br/><br/>Deploying using both tools during the speedrun was part of the challenge to show how easy it was to get started with &quot;serverless&quot; XD</p></section><section><h2>Thanks for listening!</h2><hr/><p>Linkedin / Github : <a href="https://bit.ly/weiyuan" target="_blank">bit.ly/weiyuan</a></p><img data-src="/slides/_next/static/images/qr_code.ecc21fde81fc04e.png" style="max-height:20%;max-width:20%;width:20%"/></section></div></div></div><script id="__NEXT_DATA__" type="application/json">{"dataManager":"[]","props":{"pageProps":{}},"page":"/events/la-kopi-serverless-2019-10-23","query":{},"buildId":"-e3eD8hdXzp4DvZnnEhFP","assetPrefix":"/slides","runtimeConfig":{"basePath":"/slides","gaID":"UA-138723882-1","searchConsoleID":"1yJwtZmUEW1QsrrIvRrXiBHA4O1yBmKeJBxP3txMgrI"},"nextExport":true,"autoExport":true}</script><script nomodule="" src="/slides/_next/static/runtime/polyfills-d567577529c804765e74.js"></script><script async="" data-next-page="/events/la-kopi-serverless-2019-10-23" src="/slides/_next/static/-e3eD8hdXzp4DvZnnEhFP/pages/events/la-kopi-serverless-2019-10-23.js"></script><script async="" data-next-page="/_app" src="/slides/_next/static/-e3eD8hdXzp4DvZnnEhFP/pages/_app.js"></script><script src="/slides/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" async=""></script><script src="/slides/_next/static/chunks/commons.6f1451d25cef949d9e7d.js" async=""></script><script src="/slides/_next/static/runtime/main-188324fc68481e6230d8.js" async=""></script><script src="/slides/_next/static/chunks/styles.18a0b7b5f0329dd7ac6b.js" async=""></script><script defer="" async="" src="https://www.googletagmanager.com/gtag/js?id=UA-138723882-1"></script></body></html>