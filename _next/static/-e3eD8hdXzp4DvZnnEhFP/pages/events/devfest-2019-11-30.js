(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"/wpB":function(e,n){e.exports="/slides/_next/static/images/reviewStep6a.11eee918119f476.png"},"8cM0":function(e,n){e.exports="/slides/_next/static/images/reviewStep2a.61f2e11a3652a58.png"},CDZe:function(e,n){e.exports="/slides/_next/static/images/reviewStep6c.3692eb39c2f0d36.png"},NGcr:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/events/devfest-2019-11-30",function(){return a("e28Q")}])},Q0tb:function(e,n){e.exports="/slides/_next/static/images/reviewStep2c.fc80afd93ceb437.png"},VQkF:function(e,n){e.exports="/slides/_next/static/images/reviewStep3.9104ebf444c8246.png"},"Yy+9":function(e,n){e.exports="/slides/_next/static/images/reviewStep4.29621b28303b57d.png"},d8E4:function(e,n){e.exports="/slides/_next/static/images/reviewStep1.2fe5f89339293cf.png"},e28Q:function(e,n,a){"use strict";a.r(n),a.d(n,"default",(function(){return $}));var t=a("0iUn"),s=a("sLSF"),i=a("MI3g"),l=a("a7VT"),o=a("Tit0"),c=a("q1tI"),r=a.n(c),u=a("8Kt/"),d=a.n(u),m=a("uWjd"),g=a("yLiY"),p=a.n(g),h=a("IcOa"),b=a("egVm"),f=a.n(b),N=a("d8E4"),v=a.n(N),w=a("8cM0"),C=a.n(w),A=a("o2C1"),y=a.n(A),k=a("Q0tb"),_=a.n(k),x=a("VQkF"),S=a.n(x),E=a("Yy+9"),I=a.n(E),j=a("v7Z+"),T=a.n(j),R=a("/wpB"),B=a.n(R),D=a("fuur"),M=a.n(D),P=a("CDZe"),q=a.n(P),F=a("v/1N"),O=a.n(F),V=a("rLrU"),J=a.n(V),L=a("eu/J"),Q=a.n(L),W=r.a.createElement,U=p()().publicRuntimeConfig.basePath||"",Y=["".concat(U,"/static/reveal-3.8.0/theme/sky.css"),"".concat(U,"/static/reveal-3.8.0/reveal.css"),"".concat(U,"/static/reveal-3.8.0/lib/monokai.css")],Z=[{src:"".concat(U,"/static/reveal-3.8.0/plugin/markdown/marked.js")},{src:"".concat(U,"/static/reveal-3.8.0/plugin/markdown/markdown.js")},{src:"".concat(U,"/static/reveal-3.8.0/plugin/notes/notes.js"),async:!0},{src:"".concat(U,"/static/reveal-3.8.0/plugin/highlight/highlight.js"),async:!0}],$=function(e){function n(e){var a;return Object(t.a)(this,n),(a=Object(i.a)(this,Object(l.a)(n).call(this,e))).title="Doing more with (server)less",a.description="P2, 10 steps in 10 minutes",a}return Object(o.a)(n,e),Object(s.a)(n,[{key:"componentDidMount",value:function(){window.Reveal=Object(m.revealInit)(),window.Reveal.initialize({dependencies:Z,slideNumber:"c/t"})}},{key:"render",value:function(){return W(r.a.Fragment,null,W(d.a,null,W("title",null,this.title),W("meta",{name:"twitter:card",content:"summary"}),W("meta",{property:"og:title",content:this.title}),W("meta",{property:"og:description",content:this.description}),W("meta",{property:"og:image",content:f.a}),Y.map((function(e,n){return W("link",{key:n,rel:"stylesheet",href:e})}))),W("div",{className:"reveal background-white-translucent"},W("div",{className:"slides"},W("section",null,W("h2",null,"Doing More With (Server)less"),W("p",null,'"P2, 10 steps in 10 minutes"'),W("img",{src:f.a,className:"banner image-s"}),W("p",null,W("small",null,"By ",W("a",{href:h.a.WEIYUAN.SITE},"Weiyuan Liu | Rakuten Viki")))),W("section",null,W("h3",null,"Overview"),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},"Created new Google Cloud Platform project"),W("li",{className:"fragment"},"Deployed CICD pipeline with Cloud Build"),W("li",{className:"fragment"},"Assigned roles to service account for Cloud Build to perform deployment for App Engine and Cloud Run "),W("li",{className:"fragment"},"Deployed applications to App Engine & Cloud Run"))),W("section",null,W("h3",null,"Let's examine the speedrun,",W("br",null)," in ",W("b",null,"10")," distinct steps")),W("section",null,W("h5",null,"#1 - Create the Project"),W("img",{"data-src":v.a,className:"image-m"})),W("section",null,W("h5",null,"#2a - Enable App Engine "),W("img",{"data-src":C.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6 "},W("li",{className:"fragment"},'Assess the above from the Navigation Menu - "App Engine > Dashboard"'),W("li",{className:"fragment"},"Click the ",W("b",null,"Create Application")," button"))),W("section",null,W("h5",null,"#2b - Select App Engine Region"),W("img",{"data-src":y.a,className:"image-m"})),W("section",null,W("h5",null,"#2c - Set App Engine Core Configuration"),W("img",{"data-src":_.a,className:"image-m"}),W("p",{className:"pseudo-h6s"},"See more on choosing the appropriate",W("br",null)," App Engine environment ",W("a",{href:"https://cloud.google.com/appengine/docs/the-appengine-environments",target:"_blank"},"here"))),W("section",null,W("h5",null,"#3 - Enable App Engine Admin API"),W("img",{"data-src":S.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},'Assess the above from the Navigation Menu - "APIs & Services > Dashboard"'),W("li",{className:"fragment"},'Search for "App Engine Admin API" and click the ',W("b",null,"Enable")," button"),W("li",{className:"fragment"},"See ",W("a",{href:"https://cloud.google.com/appengine/docs/admin-api/overview",target:"_blank"},"here")," on why this API is required"))),W("section",null,W("h5",null,"#4 - Enable Cloud Run"),W("img",{"data-src":I.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},'Assess the above from the Navigation Menu - "Cloud Run"'),W("li",{className:"fragment"},"Click the ",W("b",null,"Start Using Cloud Run")," button"))),W("section",null,W("h5",null,"#5 - Enable Cloud Build (for CI/CD)"),W("img",{"data-src":T.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},'Assess the above from the Navigation Menu - "Cloud Build"'),W("li",{className:"fragment"},"Click the ",W("b",null,"Enable Cloud Build API")," button"))),W("section",null,W("h5",null,"#6a - Add Cloud Build configuration"),W("img",{"data-src":B.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},'Assess the above from the Navigation Menu - "Cloud Build > Triggers"'),W("li",{className:"fragment"},"Click ",W("b",null,"Connect Repository")))),W("section",null,W("h5",null,"#6b - Connect Repository"),W("img",{"data-src":M.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},"Select the correct code repository product that you are using"),W("li",{className:"fragment"},"Click ",W("b",null,"Continue")," once you're ready"))),W("section",null,W("h5",null,"#6c - Proceed to add build trigger"),W("img",{"data-src":q.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},"Click ",W("b",null,"Add Trigger")))),W("section",null,W("h5",null,"#6d - Setting up build steps"),W("img",{"data-src":O.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},'Select the "Build configuration" setting as seen above'),W("li",{className:"fragment"},"Add branch regex (optional) if you only want to target a certain group of branches"),W("li",{className:"fragment"},"Click ",W("b",null,"Create Trigger")))),W("section",null,W("h5",null,"#7 - Add IAM roles to Cloud Build Service Account"),W("img",{"data-src":J.a,className:"image-m"}),W("ul",{className:"aquablue-list pseudo-h6"},W("li",{className:"fragment"},'Assess the above from the Navigation Menu - "IAM & admin > IAM"'),W("li",{className:"fragment"},"Add the above IAM roles to ",W("b",null,"${id}@cloudbuild.gserviceaccount.com"),". This is a service account that is the underlying identity when running Cloud Build."),W("li",{className:"fragment"},'View the privileges offered under the above roles from Navigation Menu - "IAM & admin > Roles"'))),W("section",null,W("h5",null,"#8 - Add App Engine Configuration to codebase"),W("pre",null,W("code",{className:"hljs yaml"},"runtime: nodejs10\ninstance_class: B1\nmanual_scaling:\n  instances: 1\n\nhandlers:\n- url: /static\n  static_dir: static\n- url: /public\n  static_dir: public\n- url: /client-assets\n  static_dir: client-assets                ")),W("p",{className:"pseudo-h6 fragment"},"Add the above in the root dir of project as ",W("b",null,"app.yaml")),W("p",{className:"pseudo-h6 fragment"},"App Engine configuration differs between environment (Standard VS Flexible). Do check out the standard configuration ",W("a",{href:"https://cloud.google.com/appengine/docs/standard/nodejs/config/appref",target:"_blank"},"here")," and flexible configuration ",W("a",{href:"https://cloud.google.com/appengine/docs/flexible/nodejs/reference/app-yaml",target:"_blank"},"here")," ."),W("p",{className:"pseudo-h6 fragment"},"See code base that I used ",W("a",{href:"https://github.com/Weiyuan-Lane/slides/tree/backup/serverless-demo",target:"_blank"},"here")," .")),W("section",null,W("h5",null,"#9 - Add Cloud Build Configuration to codebase"),W("pre",null,W("code",{className:"hljs yaml"},"timeout: '600s'\nsteps:\n- id: init\n  waitFor: ['-']\n  name: 'gcr.io/cloud-builders/npm'\n  args: ['install']\n\n- id: frontendTest\n  waitFor: ['init']\n  name: 'gcr.io/cloud-builders/npm'\n  args: ['run', 'f-test']\n\n- id: backendTest\n  waitFor: ['init']\n  name: 'gcr.io/cloud-builders/npm'\n  args: ['run', 'b-test']\n\n- id: buildAssets\n  waitFor: ['frontendTest', 'backendTest']\n  name: 'gcr.io/cloud-builders/npm'\n  args: ['run', 'build']\n\n- id: appEngineDeploy\n  waitFor: ['buildAssets']\n  name: 'gcr.io/cloud-builders/gcloud'\n  args: ['app', 'deploy', '-q', '--project', '$PROJECT_ID']\n\n- id: cloudRunDeploy\n  waitFor: ['frontendTest', 'backendTest']\n  name: 'gcr.io/cloud-builders/gcloud'\n  entrypoint: 'sh'\n  args:\n    - -c\n    - |\n      gcloud builds submit --tag gcr.io/$PROJECT_ID/webapp:1 -q\n      gcloud beta run deploy --image gcr.io/$PROJECT_ID/webapp:1 -q --allow-unauthenticated --platform=\"managed\" --region=\"us-central1\" webapp\n                ")),W("p",{className:"pseudo-h6 fragment"},"Add the above in the root dir of project as ",W("b",null,"cloudbuild.yaml")),W("p",{className:"pseudo-h6 fragment"},"The above runs the application's unit tests, before building the assets and deploying the applications to Cloud Run and App Engine. See ",W("a",{href:"https://cloud.google.com/cloud-build/docs/build-config",target:"_blank"},"here")," for more details on Cloud Build's configuration.")),W("section",null,W("h5",null,"#10 - Commit the configurations"),W("img",{"data-src":Q.a,className:"image-m"}),W("p",{className:"pseudo-h6 fragment"},"Committing the code above will trigger Cloud Build to starting building based on the trigger from ",W("b",null,"#6"))),W("section",null,W("h4",null,"Viola! Wait for a few minutes before your web applications are deployed"),W("br",null)))))}}]),n}(r.a.Component)},egVm:function(e,n){e.exports="/slides/_next/static/images/introPic.0b53883ee5a9ec0.png"},"eu/J":function(e,n){e.exports="/slides/_next/static/images/reviewStep10.70046fc7a05b500.png"},fuur:function(e,n){e.exports="/slides/_next/static/images/reviewStep6b.57870297235325c.png"},o2C1:function(e,n){e.exports="/slides/_next/static/images/reviewStep2b.612e2e589dd85d3.png"},rLrU:function(e,n){e.exports="/slides/_next/static/images/reviewStep7.91f70811ef987c2.png"},"v/1N":function(e,n){e.exports="/slides/_next/static/images/reviewStep6d.087b4f477373ba5.png"},"v7Z+":function(e,n){e.exports="/slides/_next/static/images/reviewStep5.78a3aa8060cb2f0.png"}},[["NGcr",0,1]]]);